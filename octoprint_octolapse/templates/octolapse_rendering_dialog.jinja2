<!--
##################################################################################
# Octolapse - A plugin for OctoPrint used for making stabilized timelapse videos.
# Copyright (C) 2019  Brad Hochgesang
##################################################################################
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published
# by the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see the following:
# https://github.com/FormerLurker/Octolapse/blob/master/LICENSE
#
# You can contact the author either through the git-hub repository, or at the
# following email address: FormerLurker@pm.me
##################################################################################
-->
<script type="text/html" id="octolapse-rendering-dialog-template">

    <ul class="nav nav-pills">
        <li class="dropdown pull-right tabdrop hide">
            <a class="dropdown-toggle" data-toggle="dropdown">
                <i class="icon-align-justify"></i>
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu"></ul>
        </li>
        <li class="active">
            <a id="octolapse_rendering_dialog_in_process_button" href="#octolapse_redering_dialog_in_process_tab" data-toggle="tab" data-profile-type="main-settings" data-bind="click: function(){dialog.resize(); return true;}">Processing</a>
        </li>
        <li>
            <a id="octolapse_rendering_dialog_unfinished_button" href="#octolapse_redering_dialog_unfinished_tab" data-toggle="tab" data-profile-type="main-settings"  data-bind="click: function(){dialog.resize(); return true;}">Failed</a>
        </li>
    </ul>
    <div class="tab-content">
        <div id="octolapse_redering_dialog_in_process_tab" class="tab-pane active">
            <div data-bind="visible: in_process_renderings().length > 0">
                <p>
                    There are <span data-bind="text: in_process_renderings_size_formatted"></span> of images in <span data-bind="text: in_process_renderings().length"></span> renderings currently being processed.
                </p>
                <hr/>
                <div>
                    <table class="table table-striped table-hover table-condensed table-hover octolapse-table-list">
                        <thead>
                        <tr>
                            <th class="rendering_print_name">Print</th>
                            <th class="rendering_print_end_state">Status</th>
                            <th class="rendering_size">Size</th>
                            <th class="rendering_date">Date</th>
                            <th class="rendering_camera_name">Camera</th>
                            <th class="rendering_name">Rendering</th>
                            <th class="rendering_progress text-center">Progress</th>
                        </tr>
                        </thead>
                        <tbody data-bind="foreach: { data: in_process_renderings, as: 'rendering' }">
                        <tr>
                            <td class="rendering_print_name" data-bind="text: rendering.print_file_name, attr: {title: rendering.print_file_name}"></td>
                            <td class="rendering_print_end_state" data-bind="text: rendering.print_end_state, attr: {title: rendering.print_end_state}"></td>
                            <td class="rendering_size" data-bind="text: rendering.file_size_formatted, attr: {title: rendering.file_size_formatted}"></td>
                            <td class="rendering_date" data-bind="text: rendering.print_start_time, attr: {title: rendering.print_start_time}"></td>
                            <td class="rendering_camera_name">
                                <span data-bind="text: rendering.camera_name"></span>
                            </td>
                            <td class="rendering_name">
                                <span data-bind="text: rendering.rendering_name"></span>
                            </td>
                            <td class="rendering_progress text-center">
                                <span data-bind="text: rendering.progress, attr:{title: rendering.progress}"></span>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div data-bind="visible: in_process_renderings().length == 0">
                <p>
                    No timelapses are currently being rendered.
                </p>
            </div>
        </div>
        <div id="octolapse_redering_dialog_unfinished_tab" class="tab-pane">
            <div data-bind="visible: unfinished_renderings().length > 0">
                <div>
                    <p>
                        There are <span data-bind="text: unfinished_renderings().length"></span> unfinished renderings taking up <span data-bind="text: unfinished_renderings_size_formatted"></span> of disk space.
                    </p>
                </div>
                <fieldset class="octolapse">
                    <legend>Render or Delete All</legend>
                    <div class="row-fluid">
                        <div class="span4">
                            <strong>Rendering Profile</strong>
                        </div>
                        <div class="span4">
                            <strong>Camera Profile</strong>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span4">
                            <select class="input-block-level"
                                    data-bind="
                                        options: Octolapse.Status.renderings_sorted,
                                        optionsText: 'name',
                                        optionsValue: 'guid',
                                        value: render_profile_override_guid,
                                        optionsCaption: 'Use Original Rendering Profile'">
                            </select>
                        </div>
                        <div class="span4">
                            <select class="input-block-level"
                                    data-bind="
                                        options: Octolapse.Status.cameras_sorted,
                                        optionsText: 'name',
                                        optionsValue: 'guid',
                                        value: camera_profile_override_guid,
                                        optionsCaption: 'Use Original Camera Profile'">
                            </select>
                        </div>
                        <div class="span4">
                            <button type="button"
                                    data-bind="click: render_all"
                                    class="span6 btn btn-default ok input-block-level">Render All</button>
                            <button type="button"
                                    data-bind="click: delete_all"
                                    class="span6 btn btn-default ok input-block-level">Delete All</button>
                        </div>
                    </div>
                </fieldset>
                <hr/>
                <div>
                    <table class="table table-striped table-hover table-condensed table-hover octolapse-table-list">
                        <thead>
                        <tr>
                            <th class="rendering_print_name">Print</th>
                            <th class="rendering_print_end_state">Status</th>
                            <th class="rendering_size">Size</th>
                            <th class="rendering_date">Date</th>
                            <th class="rendering_camera_name">Camera</th>
                            <th class="rendering_name">Rendering</th>
                            <th class="rendering_action text-center">Action</th>
                        </tr>
                        </thead>
                        <tbody data-bind="foreach: { data: unfinished_renderings, as: 'rendering' }">
                        <tr>
                            <td class="rendering_print_name" data-bind="text: rendering.print_file_name, attr: {title: rendering.print_file_name}"></td>
                            <td class="rendering_print_end_state" data-bind="text: rendering.print_end_state, attr: {title: rendering.print_end_state}"></td>
                            <td class="rendering_size" data-bind="text: rendering.file_size_formatted, attr: {title: rendering.file_size_formatted}"></td>
                            <td class="rendering_date" data-bind="text: rendering.print_start_time, attr: {title: rendering.print_start_time}"></td>
                            <td class="rendering_camera_name">
                                <select
                                    class="input-block-level"
                                    data-bind="
                                        options: Octolapse.Status.cameras_sorted,
                                        optionsText: 'name',
                                        optionsValue: 'guid',
                                        value: rendering.camera_profile_override_guid,
                                        optionsCaption: rendering.getCameraOptionCaption(),">
                                </select>
                            </td>
                            <td class="rendering_name">
                                <select
                                    class="input-block-level"
                                    data-bind="
                                        options: Octolapse.Status.renderings_sorted,
                                        optionsText: 'name',
                                        optionsValue: 'guid',
                                        value: rendering.render_profile_override_guid,
                                        optionsCaption: rendering.getRenderingOptionCaption(),
                                        optionsAfterRender: rendering.setRenderingProfileOptionDescriptionAsTitle">
                                </select>
                            </td>
                            <td class="rendering_action text-center">
                                    <a class="fa icon-film" title="Render with selected settings" data-bind="click: function(){ $parent.render(rendering);}"></a>
                                    &nbsp;|&nbsp;<a class="fa fa-trash-o" title="Delete unfinished rendering" data-bind="click: function(){ $parent.delete(rendering);}"></a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div data-bind="visible: unfinished_renderings().length == 0">
                There are no unfinished renderings.
            </div>
        </div>
    </div>


</script>

